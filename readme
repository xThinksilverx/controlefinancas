# ğŸ’° Sistema de Controle de FinanÃ§as Pessoais

Sistema web completo para gerenciamento de finanÃ§as pessoais, permitindo registro de receitas e despesas, anexo de cupons fiscais, visualizaÃ§Ã£o de saldo e histÃ³rico financeiro.

---

## ğŸ“ DescriÃ§Ã£o

Sistema desenvolvido para controle financeiro pessoal que permite aos usuÃ¡rios:
- Criar conta e fazer login de forma segura
- Registrar receitas e despesas por categoria
- Anexar cupons fiscais em PDF
- Visualizar saldo atual, total de receitas e despesas
- Consultar histÃ³rico completo de transaÃ§Ãµes
- Excluir transaÃ§Ãµes

O sistema foi desenvolvido com foco em **seguranÃ§a**, implementando proteÃ§Ãµes contra as principais vulnerabilidades web.

---

## ğŸš€ Tecnologias Utilizadas

### Backend
- **Node.js** v14+ - Runtime JavaScript
- **Express.js** v4.18 - Framework web
- **MySQL2** v3.6 - Banco de dados com suporte a Promises
- **bcrypt** v5.1 - Hash de senhas
- **express-validator** v7.0 - ValidaÃ§Ã£o de dados
- **helmet** v7.1 - ProteÃ§Ã£o de headers HTTP
- **express-rate-limit** v7.1 - LimitaÃ§Ã£o de requisiÃ§Ãµes
- **xss-clean** v0.1 - ProteÃ§Ã£o contra XSS
- **hpp** v0.2 - ProteÃ§Ã£o contra HTTP Parameter Pollution
- **multer** v1.4 - Upload de arquivos
- **dotenv** v16.3 - VariÃ¡veis de ambiente

### Frontend
- **React** v18 - Biblioteca JavaScript
- **Tailwind CSS** v3.4 - Framework CSS
- **Lucide React** - Ãcones

### Banco de Dados
- **MySQL** v8.0+ - Sistema de gerenciamento de banco de dados

---

## âœ¨ Funcionalidades

- âœ… Cadastro e login de usuÃ¡rios
- âœ… Adicionar receitas (SalÃ¡rio, Freelance, Investimentos, Outros)
- âœ… Adicionar despesas (AlimentaÃ§Ã£o, Transporte, Moradia, Lazer, SaÃºde, EducaÃ§Ã£o, Outros)
- âœ… Upload de cupom fiscal (PDF, mÃ¡x 5MB)
- âœ… VisualizaÃ§Ã£o de saldo total
- âœ… HistÃ³rico de transaÃ§Ãµes ordenado por data
- âœ… ExclusÃ£o de transaÃ§Ãµes
- âœ… EstatÃ­sticas em tempo real

---

## ğŸ”’ SeguranÃ§a

O sistema implementa proteÃ§Ãµes contra as seguintes vulnerabilidades:

### 1. SQL Injection âœ…
**ProteÃ§Ã£o:** Queries parametrizadas em 100% das consultas

```javascript
// âŒ VULNERÃVEL
db.query(`SELECT * FROM usuarios WHERE email = '${email}'`)

// âœ… IMPLEMENTADO
const [users] = await db.query(
  'SELECT * FROM usuarios WHERE email = ?',
  [email]
);
```

### 2. Cross-Site Scripting (XSS) âœ…
**ProteÃ§Ã£o:** SanitizaÃ§Ã£o de inputs + Helmet + CSP

```javascript
// Middleware de sanitizaÃ§Ã£o
const sanitizeInput = (req, res, next) => {
  Object.keys(req.body).forEach(key => {
    if (typeof req.body[key] === 'string') {
      req.body[key] = req.body[key]
        .replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, '')
        .replace(/<[^>]*>/g, '')
        .trim();
    }
  });
  next();
};
```

### 3. Cross-Site Request Forgery (CSRF) âœ…
**ProteÃ§Ã£o:** CORS restrito + ValidaÃ§Ã£o de origem

```javascript
app.use(cors({
  origin: process.env.FRONTEND_URL || 'http://localhost:3000',
  credentials: true,
  methods: ['GET', 'POST', 'PUT', 'DELETE']
}));
```

### 4. Mass Assignment âœ…
**ProteÃ§Ã£o:** Whitelist de campos permitidos

```javascript
const allowFields = (allowedFields) => {
  return (req, res, next) => {
    const filteredBody = {};
    allowedFields.forEach(field => {
      if (req.body[field] !== undefined) {
        filteredBody[field] = req.body[field];
      }
    });
    req.body = filteredBody;
    next();
  };
};
```

### 5. Session Hijacking âœ…
**ProteÃ§Ã£o:** Rate limiting + Bcrypt forte

```javascript
// Rate limiting
const loginLimiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 minutos
  max: 5, // 5 tentativas
});

// Hash forte
const hashedPassword = await bcrypt.hash(password, 12);
```

### 6. Hardcoded SQL âœ…
**ProteÃ§Ã£o:** 0% de SQL hardcoded - 100% parametrizado

Todas as queries usam prepared statements com placeholders.

---

## ğŸ“¦ InstalaÃ§Ã£o

### PrÃ©-requisitos
1. **Node.js** (v14+) - https://nodejs.org/
2. **XAMPP** - https://www.apachefriends.org/

### Passo 1: Configurar Banco de Dados

1. Inicie o **XAMPP** e ligue o **MySQL**
2. Acesse http://localhost/phpmyadmin
3. Crie o banco `banco_padaria`
4. Execute o script `database.sql`

### Passo 2: Backend

```bash
cd backend
npm install express mysql2 cors bcrypt multer express-validator helmet express-rate-limit xss-clean hpp cookie-parser dotenv
copy .env.example .env
#edita o env com as credenciaisi
npm start
```

### Passo 3: Frontend

```bash
cd frontend
npm install
npm install -D tailwindcss@3.4.1 postcss autoprefixer
npm install lucide-react
npx tailwindcss init -p
npm start
```

---

## ğŸš€ Como Executar

### Iniciar Backend
```bash
cd backend
npm start
# Servidor: http://localhost:3001
```

### Iniciar Frontend
```bash
cd frontend
npm start
# AplicaÃ§Ã£o: http://localhost:3000
```

---

## ğŸ“ Estrutura do Projeto

```
finance-control/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”‚   â””â”€â”€ database.js
â”‚   â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â”‚   â”œâ”€â”€ authController.js
â”‚   â”‚   â”‚   â””â”€â”€ transactionController.js
â”‚   â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”‚   â”œâ”€â”€ authRoutes.js
â”‚   â”‚   â”‚   â””â”€â”€ transactionRoutes.js
â”‚   â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â”‚   â”œâ”€â”€ uploadMiddleware.js
â”‚   â”‚   â”‚   â”œâ”€â”€ validationMiddleware.js
â”‚   â”‚   â”‚   â””â”€â”€ securityMiddleware.js
â”‚   â”‚   â””â”€â”€ app.js
â”‚   â”œâ”€â”€ uploads/
â”‚   â”œâ”€â”€ server.js
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ .env
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ App.js
â”‚   â”‚   â””â”€â”€ index.css
â”‚   â””â”€â”€ package.json
â””â”€â”€ database.sql
```

---

## ğŸ”Œ API Endpoints

### POST `/api/register`
Cadastrar usuÃ¡rio
```json
{
  "name": "JoÃ£o Silva",
  "email": "joao@email.com",
  "password": "Senha123"
}
```

### POST `/api/login`
Fazer login
```json
{
  "email": "joao@email.com",
  "password": "Senha123"
}
```

### POST `/api/transactions`
Criar transaÃ§Ã£o (multipart/form-data)

### GET `/api/transactions/:userId`
Listar transaÃ§Ãµes

### DELETE `/api/transactions/:id`
Deletar transaÃ§Ã£o

### GET `/api/stats/:userId`
Obter estatÃ­sticas

---

## ğŸ§ª Testando a SeguranÃ§a

### SQL Injection
```bash
# Email: admin' OR '1'='1
# Resultado: âŒ Bloqueado
```

### XSS
```bash
# DescriÃ§Ã£o: <script>alert('XSS')</script>
# Resultado: âœ… Script removido
```

### Mass Assignment
```json
{
  "name": "Test",
  "email": "test@test.com",
  "password": "123456",
  "admin": true
}
// Resultado: âœ… Campo 'admin' ignorado
```


